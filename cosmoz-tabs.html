<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../paper-tabs/paper-tab.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="../iron-resizable-behavior/iron-resizable-behavior.html">
<link rel="import" href="../iron-selector/iron-multi-selectable.html">
<link rel="import" href="../cosmoz-page-router/cosmoz-page-location.html">

<link rel="import" href="cosmoz-tab.html">

<!--
`<cosmoz-tabs>` is a multi views (or pages) container element that allow navigation between the views
using tabs or an accordion.

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--paper-tabs-selection-bar-color` | Color for the selection bar | `#00b4db`

@demo demo/index.html
-->
<dom-module id="cosmoz-tabs">
	<template>
		<style>
			:host {
				position: relative;
				@apply --layout-vertical;
			}

			paper-material {
				margin-bottom: 3px;
			}


			#paperTabs {
				background-color: #fff;
				--paper-tabs-selection-bar-color: var(--cosmoz-tabs-selection-bar-color, #00b4db);
			}

			#accordion-layout {
				position: relative;
			}

			h1.heading {
				font-family: sans-serif;
				font-size: 1.14em;
				font-weight: 300;
				margin-right: 30px;
				text-overflow: ellipsis;
				white-space: nowrap;
				padding: 0;
				overflow: hidden;
	  		}

			.headingIcon {
				height: 13px;
				width: 13px;
				margin: 0 10px 0 10px;
				flex-shrink: 0;
			}

			paper-tab.iron-selected h1.heading {
				font-weight: 400;
			}

			paper-tab[disabled] {
				opacity: 0.65;
			}

			.link {
				@apply --layout-horizontal;
				@apply --layout-center-center;
				text-decoration: none;
				color: inherit;
				/* TODO(accessibility): focused tab should be outlined */
				outline: 0;
			}

			.flex-scroll {
				overflow-y: auto;
				will-change: transform;
			}

			[hidden] {
				display: none;
			}

			paper-badge {
				--paper-badge-margin-left: 25px;
			}


			:host(.flex),
			:host(.flex) > #standard-layout,
			:host(.flex) > #standard-layout > iron-pages {
				@apply --layout-vertical;
				@apply --layout-flex;
			}

			:host(:not([accordion])) .pages ::slotted(:not(.cosmoz-selected)) {
				display: none !important;
			}

		</style>

		<cosmoz-page-location id="pageLocation" route-hash-params="{{ _routeHashParams }}"></cosmoz-page-location>

		<template is="dom-if" if="[[ !accordion ]]" restamp>
			<paper-material elevation="1">
				<paper-tabs id="paperTabs" selected="{{ selected }}" attr-for-selected="{{ attrForSelected }}" no-slide>
					<template is="dom-repeat" items="[[ items ]]" as="tab" index-as="tabIndex">
						<paper-tab hidden$="[[ tab.hidden ]]" disabled="[[ tab.disabled ]]" data-tabid$="[[ tab.tabId ]]">
							<a href$="[[ _getTabLink(tab, _routeHashParams.*) ]]" tabindex="-1" class="link">
								<iron-icon hidden class="headingIcon" icon="[[ _getIcon(tab, selectedTabId, accordion) ]]"
									style$="[[ _computeTabIconStyle(tab.iconColor) ]]"></iron-icon>
								<h1 id$="tabHeading[[tabIndex]]" class="heading">[[ tab.heading ]]</h1>
								<paper-badge for="tabHeading[[tabIndex]]" hidden$="[[ !tab.badge ]]" label="[[ tab.badge ]]"></paper-badge>
							</a>
						</paper-tab>
					</template>
				</paper-tabs>
			</paper-material>
		</template>

		<div class="pages">
			<slot></slot>
		</div>

	</template>
	<script type="text/javascript" src="cosmoz-tabs.js"></script>
</dom-module>
